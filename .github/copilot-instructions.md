# Project Guidelines for AI Coding Agents

## Purpose
This file gives concise, actionable conventions for AI coding agents working in this repository so generated changes align with existing patterns.

## Code Style
- Follow Prettier settings in `movies-app/package.json` (printWidth: 100, singleQuote: true). HTML uses the `angular` parser.
- Use TypeScript settings from `movies-app/tsconfig*.json`. Preserve existing types and module patterns.
- SCSS is used for styles; components generated by Angular schematics should use `scss` (see `angular.json`).

## Architecture (what to know)
- Single Angular application with optional SSR. Client entry: `movies-app/src/main.ts`; server entry: `movies-app/src/main.server.ts` and `movies-app/server.ts`.
- Routing split into client/server route files: `movies-app/src/app/app.routes.ts` and `movies-app/src/app/app.routes.server.ts`.
- State uses NgRx when present; domain models live under `movies-app/src/app/models/` (see `movie.ts`).

## Build & Test Commands
- Install dependencies in the `movies-app/` folder: `npm ci` (or `npm install`).
- Start dev server: `npm start` (runs `ng serve`).
- Build: `npm run build`.
- Watch dev build: `npm run watch`.
- Unit tests: `npm test` (Vitest via `ng test`).
- Serve SSR build: `npm run serve:ssr:movies-app` (runs `node dist/movies-app/server/server.mjs`).

## Project Conventions (concrete patterns)
- Services: keep small and focused; prefer DI over singletons. Example: `movies-app/src/app/services/movie-service.ts`.
- Models: simple interfaces/classes under `movies-app/src/app/models/` (see `movies-app/src/app/models/movie.ts`).
- Tests: colocated with implementation, using `*.spec.ts` naming (`app.spec.ts`, `movie-service.spec.ts`).
- Prefer small, incremental changes and add/update unit tests for behavior changes.

## Integration Points
- SSR uses Express; server wiring is in `movies-app/server.ts` and `movies-app/main.server.ts`.
- NgRx is available: follow existing store slices if modifying global state.
- Centralize external API calls in services under `movies-app/src/app/services/` and mock them in tests.

## Security & Secrets
- Never add credentials or secrets to the repo. Use environment variables and document required vars in PRs.
- Sanitize user input before rendering in SSR paths to avoid XSS.

## Editing Guidance for Agents
- Always run the repository's build and tests after non-trivial changes in `movies-app/`:

```bash
cd movies-app
npm ci
npm test
```

- Keep changes minimal and focused. Reference files in PR descriptions (example links):
  - Client entry: `movies-app/src/main.ts`
  - Server: `movies-app/server.ts`
  - Movie model: `movies-app/src/app/models/movie.ts`
  - Movie service: `movies-app/src/app/services/movie-service.ts`

- When updating SSR/server code, ensure server bundle path in `package.json` `serve:ssr:movies-app` matches artifact layout.

If you'd like CI snippets, lint rules, or a short checklist for PRs, tell me which to add and I will extend this file.
